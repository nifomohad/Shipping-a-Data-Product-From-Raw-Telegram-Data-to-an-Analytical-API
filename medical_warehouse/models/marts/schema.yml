version: 2

models:
  - name: dim_channels
    description: "Dimension table containing metadata and aggregated performance metrics for each unique Telegram channel."
    columns:
      - name: channel_key
        description: "Primary key: A unique surrogate key generated by an MD5 hash of the channel_name."
        tests:
          - unique
          - not_null
      - name: channel_name
        description: "The unique Telegram handle/username for the channel."
      - name: channel_type
        description: "Categorization of the channel (e.g., Pharmaceutical, Cosmetics, Medical) based on its content."
      - name: first_post_date
        description: "The timestamp of the first message collected from this channel."
      - name: last_post_date
        description: "The timestamp of the most recent message collected from this channel."
      - name: total_posts
        description: "The total count of messages processed for this channel."
      - name: avg_views
        description: "The average number of views per post for this channel."

  - name: dim_dates
    description: "A date dimension table used to facilitate time-series analysis and grouping by calendar attributes."
    columns:
      - name: date_key
        description: "Primary key: An integer representation of the date in YYYYMMDD format."
        tests:
          - unique
          - not_null
      - name: full_date
        description: "The full date value."
      - name: day_name
        description: "The name of the day of the week (e.g., Sunday)."
      - name: day_of_week
        description: "The numeric day of the week, where 0 is Sunday."
      - name: week_of_year
        description: "The ISO week number of the year."
      - name: month
        description: "The numeric month of the year."
      - name: month_name
        description: "The full name of the month (e.g., January)."
      - name: quarter
        description: "The numeric quarter of the year."
      - name: year
        description: "The four-digit year."
      - name: is_weekend
        description: "A boolean flag indicating if the date falls on a weekend."

  - name: fct_messages
    description: "The central fact table containing one record for every message processed, linked to channel and date dimensions."
    columns:
      - name: message_id
        description: "The unique ID assigned to the message by Telegram."
        tests:
          - not_null
          - unique
      - name: channel_key
        description: "Foreign key: Links the message to its respective channel in dim_channels."
        tests:
          - not_null
          - relationships:
              to: ref('dim_channels')
              field: channel_key
      - name: date_key
        description: "Foreign key: Links the message to the dim_dates dimension based on its creation date."
        tests:
          - not_null
          - relationships:
              to: ref('dim_dates')
              field: date_key
      - name: message_text
        description: "The cleaned text content of the Telegram message."
      - name: message_length
        description: "The total character count of the message content."
      - name: view_count
        description: "The total number of views recorded for the message."
        tests:
          - not_null
      - name: forward_count
        description: "The total number of times the message was forwarded."
      - name: has_image
        description: "A boolean flag indicating whether the message includes an image attachment."